{% extends "data/download_base.html" %}

{% block version_specific_controls %}
<div class="flex flex-col items-center gap-4">

  <select id="versionSelect" class="select select-primary w-28">
    <option value="v0.2" selected>v0.2</option>
    <option value="v0.1">v0.1</option>
  </select>

  <div id="searchControls" class="flex flex-wrap justify-center gap-5 mt-3">
    <div>
        <input type="text" id="nutsCodeInput" list="nutsCodeOptions" class="input input-primary min-w-[14rem]" placeholder="Search by NUTS code (e.g., DE, DE1, DE12)">
        <datalist id="nutsCodeOptions"></datalist>
    </div>
    <div id="orSeparator" class="flex items-center text-gray-400 font-semibold mx-2">
      — OR —
    </div>
    <div>
        <input type="text" id="nutsNameInput" list="nutsNameOptions" class="input input-primary min-w-[14rem]" placeholder="Search by region name (e.g., Baden-Württemberg)">
        <datalist id="nutsNameOptions"></datalist>
    </div>
  </div>
</div>
{% endblock %}

{% block version_specific_table %}
<div class="mt-6">
  <div class="overflow-y-auto overflow-y-visible max-h-96 border-base-content/5">
    <table id="downloadsTable" class="table table-compact table-zebra w-full table-fixed text-sm border-separate border-spacing-0">
        <thead>
          <tr class="sticky top-0 z-30">
            <th class="w-[15%]">NUTS ID</th>
            <th class="w-[25%]">Name</th>

            <th class="w-[20%] text-center">
              Parquet
              <div class="badge badge-success badge-xs opacity-95 tooltip tooltip-bottom normal-case font-normal tracking-normal whitespace-normal max-w-xs"
                  data-tip="RECOMMENDED: Native format. Preservation of all metadata, strict typing, and high compression.">
                !
              </div>
            </th>

            <th class="w-[20%] text-center">
              GeoPackage
              <div class="badge badge-warning badge-xs opacity-95 tooltip tooltip-bottom normal-case font-normal tracking-normal whitespace-normal max-w-xs"
                  data-tip="EXPERIMENTAL: Converted from Parquet. Minor typing discrepancies expected.">
                ⚠
              </div>
            </th>

            <th class="w-[20%] text-center">
              Shapefile
              <div class="badge badge-warning badge-xs opacity-95 tooltip tooltip-bottom normal-case font-normal tracking-normal whitespace-normal max-w-xs"
                  data-tip="EXPERIMENTAL: Converted from Parquet. Minor typing discrepancies expected. Shortened column names. Individual files may exceed 2GB legacy cap.">
                ⚠
              </div>
            </th>
          </tr>
        </thead>

        <tbody id="downloadsBody">
          <tr>
            <td colspan="5" class="text-center py-8">
              Select a country or NUTS code.
            </td>
          </tr>
        </tbody>

        <tfoot id="downloadsBottomBar" class="sticky bottom-0 z-20 bg-base-100/95 backdrop-blur-sm border-t border-base-content/10 shadow-[0_-10px_20px_-10px_rgba(0,0,0,0.2)]">
          <tr>
            <td colspan="2" class="text-right pr-6 py-4">
              <span class="text-xs font-semibold uppercase tracking-wider text-base-content/40">Bundle results:</span>
            </td>
            <td class="text-center py-4">
              <div class="tooltip tooltip-top w-full" data-tip="Download all results as Parquet (.zip)">
                <button id="btnParquet" class="btn btn-xs btn-outline btn-ghost w-full max-w-[120px]">All Parquets</button>
              </div>
            </td>
            <td class="text-center py-4">
              <div class="tooltip tooltip-top w-full" data-tip="Download all results as GeoPackage (.zip)">
                <button id="btnGpkg" class="btn btn-xs btn-outline btn-ghost w-full max-w-[120px]">All GPKG</button>
              </div>
            </td>
            <td class="text-center py-4">
              <div class="tooltip tooltip-top w-full" data-tip="Download all results as Shapefile (.zip)">
                <button id="btnShp" class="btn btn-xs btn-outline btn-ghost w-full max-w-[120px]">All SHP</button>
              </div>
            </td>
          </tr>
        </tfoot>
    </table>
  </div>
</div>
{% endblock %}
